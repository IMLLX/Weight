C51 COMPILER V9.01   WEIGH                                                                 11/14/2020 23:08:48 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE WEIGH
OBJECT MODULE PLACED IN weigh.obj
COMPILER INVOKED BY: D:\Program Files\keil\C51\BIN\C51.EXE src\weigh.c BROWSE DEBUG OBJECTEXTEND PRINT(.\weigh.lst) OBJE
                    -CT(weigh.obj)

line level    source

   1          #include "weigh.h"
   2          
   3          const unsigned char code title[] = {"硬币称重"};
   4          const unsigned char code overWeight[] = {"超出量程"};
   5          unsigned char WeightTab[6];                           // 存质量字符串
   6          
   7          float perWeight;    // 单个硬币质量
   8          float totalWeight;  // 总质量
   9          unsigned long temp; // 缓存质量
  10          unsigned char k = 0;
  11          
  12          sbit wela = P2 ^ 6;
  13          sbit dula = P2 ^ 7;
  14          
  15          void init(void);
  16          int loop(void);
  17          
  18          void main()
  19          {
  20   1          init();
  21   1          getOffset(10); // 初始化质量
  22   1          while (!loop())
  23   1              ;
  24   1      }
  25          
  26          int loop(void)
  27          {
  28   1          temp = 0;
  29   1          temp = getWeight();
  30   1          if (temp >= 1000)
  31   1          {
  32   2              display(0, 0, overWeight);
  33   2          }
  34   1          else if (temp == 0)
  35   1          {
  36   2              WeightTab[0] = '0';
  37   2              k = 1;
  38   2          }
  39   1          else
  40   1          {
  41   2              weight_init(WeightTab);
  42   2              k = 0;
  43   2              while (temp != 0)
  44   2              {
  45   3                  WeightTab[k++] = 0x30 + temp % 10; //提取十进制最后一位转换为字符
  46   3                  temp /= 10;
  47   3              }
  48   2          }
  49   1          write_cmd(0x93);
  50   1          while (k > 0)
  51   1          {
  52   2              write_data(WeightTab[k--]);
  53   2          }
  54   1          return 0;
C51 COMPILER V9.01   WEIGH                                                                 11/14/2020 23:08:48 PAGE 2   

  55   1      }
  56          
  57          void init(void)
  58          {
  59   1          wela = 0;
  60   1          dula = 0;
  61   1          delay(10);
  62   1          // time_init();
  63   1          dis_init();
  64   1          display(0, 0, title);
  65   1          display(1, 0, title);
  66   1          display(2, 0, title);
  67   1          display(3, 0, title);
  68   1      }
  69          
  70          /** 调用 times 次 nop 函数*/
  71          void Nop(unsigned char times)
  72          {
  73   1          int i = 0;
  74   1          for (i = 0; i < times; i++)
  75   1          {
  76   2              _nop_();
  77   2          }
  78   1          return;
  79   1      }
  80          
  81          /********************************************************************
  82          函数名称: void delay(unsigned int x)        
  83          功能简介: 晶振为11.0592MHZ时定时xms
  84          入口参数: unsigned int x
  85          返回值  ：无
  86          *********************************************************************/
  87          void delay(unsigned int x)
  88          {
  89   1          unsigned int i, j = 110;
  90   1          for (i = 0; i < x; i++, j = 110)
  91   1          {
  92   2              while (j--)
  93   2                  ;
  94   2          }
  95   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    347    ----
   CONSTANT SIZE    =     26    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     19    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
