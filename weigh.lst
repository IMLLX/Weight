C51 COMPILER V9.01   WEIGH                                                                 11/14/2020 14:09:16 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE WEIGH
OBJECT MODULE PLACED IN weigh.obj
COMPILER INVOKED BY: D:\Program Files\keil\C51\BIN\C51.EXE src\weigh.c BROWSE DEBUG OBJECTEXTEND PRINT(.\weigh.lst) OBJE
                    -CT(weigh.obj)

line level    source

   1          #include "weigh.h"
   2          
   3          const unsigned char title[] = {"硬币称重"};
   4          const unsigned char overWeight[] = {"超出量程"};
   5          const unsigned char clearTab[] = {"          "}; // 清屏某一行
   6          unsigned char WeightTab[6];                      // 存质量字符串
   7          
   8          float perWeight;    // 单个硬币质量
   9          float totalWeight;  // 总质量
  10          unsigned long temp; // 缓存质量
  11          unsigned char k = 0;
  12          
  13          void init(void);
  14          int loop(void);
  15          
  16          void main()
  17          {
  18   1          init();
  19   1          getOffset(10); // 初始化质量
  20   1          while (!loop())
  21   1              ;
  22   1      }
  23          
  24          int loop(void)
  25          {
  26   1          temp = 0;
  27   1          temp = getWeight();
  28   1          if (temp >= 1000)
  29   1          {
  30   2              display(0, 0, overWeight);
  31   2          }
  32   1          else if (temp == 0)
  33   1          {
  34   2              WeightTab[0] = '0';
  35   2              k = 1;
  36   2          }
  37   1          else
  38   1          {
  39   2              weight_init(WeightTab);
  40   2              k = 0;
  41   2              while (temp != 0)
  42   2              {
  43   3                  WeightTab[k++] = 0x30 + temp % 10; //提取十进制最后一位转换为字符
  44   3                  temp /= 10;
  45   3              }
  46   2          }
  47   1          write_cmd(0x93);
  48   1          while (k > 0)
  49   1          {
  50   2              write_data(WeightTab[k--]);
  51   2          }
  52   1          return 0;
  53   1      }
  54          
C51 COMPILER V9.01   WEIGH                                                                 11/14/2020 14:09:16 PAGE 2   

  55          void init(void)
  56          {
  57   1          time_init();
  58   1          dis_init();
  59   1          display(0, 0, title);
  60   1      }
  61          
  62          /** 调用 times 次 nop 函数*/
  63          void Nop(unsigned char times)
  64          {
  65   1          int i = 0;
  66   1          for (i = 0; i < times; i++)
  67   1          {
  68   2              _nop_();
  69   2          }
  70   1          return;
  71   1      }
  72          
  73          /********************************************************************
  74          函数名称: void delay(unsigned int x)        
  75          功能简介: 晶振为11.0592MHZ时定时xms
  76          入口参数: unsigned int x
  77          返回值  ：无
  78          *********************************************************************/
  79          void delay(unsigned int x)
  80          {
  81   1          unsigned int i, j = 110;
  82   1          for (i = 0; i < x; i++, j = 110)
  83   1          {
  84   2              while (j--)
  85   2                  ;
  86   2          }
  87   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    300    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     56    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
