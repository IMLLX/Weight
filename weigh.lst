C51 COMPILER V9.01   WEIGH                                                                 11/14/2020 01:32:12 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE WEIGH
OBJECT MODULE PLACED IN weigh.obj
COMPILER INVOKED BY: D:\Program Files\keil\C51\BIN\C51.EXE src\weigh.c BROWSE DEBUG OBJECTEXTEND PRINT(.\weigh.lst) OBJE
                    -CT(weigh.obj)

line level    source

   1          #include "weigh.h"
   2          
   3          const unsigned char title[] = {"硬币称重"};
   4          const unsigned char overWeight[] = {"超出量程"};
   5          const unsigned char clearTab[] = {"          "}; // 清屏某一行
   6          unsigned char WeightTab[6];                      // 存质量字符串
   7          
   8          float perWeight;    // 单个硬币质量
   9          float totalWeight;  // 总质量
  10          unsigned long temp; // 缓存质量
  11          unsigned char k = 0;
  12          
  13          void init(void);
  14          int loop(void);
  15          
  16          void main()
  17          {
  18   1          init();
  19   1          getOffset(10); // 初始化质量
  20   1          while (!loop());
  21   1      }
  22          
  23          int loop(void)
  24          {
  25   1          temp = 0;
  26   1          temp = getWeight();
  27   1          if (temp >= 1000)
  28   1          {
  29   2              display(0, 0, overWeight);
  30   2          }
  31   1          else if (temp == 0)
  32   1          {
  33   2              WeightTab[0] = '0';
  34   2          }
  35   1          else
  36   1          {
  37   2              weight_init(WeightTab);
  38   2              k = 0;
  39   2              while (temp != 0)
  40   2              {
  41   3                  WeightTab[k++] = 0x30 + temp % 10; //提取十进制最后一位转换为字符
  42   3                  temp /= 10;
  43   3              }
  44   2          }
  45   1          write_cmd(0x93);
  46   1          while (k > 0)
  47   1          {
  48   2              write_data(WeightTab[k--]);
  49   2          }
  50   1          return 0;
  51   1      }
  52          
  53          void init(void)
  54          {
C51 COMPILER V9.01   WEIGH                                                                 11/14/2020 01:32:12 PAGE 2   

  55   1          time_init();
  56   1          dis_init();
  57   1          display(0, 0, title);
  58   1      }
  59          
  60          /** 调用 times 次 nop 函数*/
  61          void Nop(unsigned char times)
  62          {
  63   1          int i = 0;
  64   1          for (i = 0; i < times; i++)
  65   1          {
  66   2              _nop_();
  67   2          }
  68   1          return;
  69   1      }
  70          
  71          /********************************************************************
  72          函数名称: void delay(unsigned int x)        
  73          功能简介: 晶振为11.0592MHZ时定时xms
  74          入口参数: unsigned int x
  75          返回值  ：无
  76          *********************************************************************/
  77          void delay(unsigned int x)
  78          {
  79   1          unsigned int i, j = 110;
  80   1          for (i = 0; i < x; i++, j = 110)
  81   1          {
  82   2              while (j--)
  83   2                  ;
  84   2          }
  85   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    297    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     56    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
